From bd07b774259910d96a2ffcfac8f32bc63d0a0540 Mon Sep 17 00:00:00 2001
From: Peter Kaestle <peter.kaestle@nokia.com>
Date: Mon, 15 Mar 2021 13:19:56 +0100
Subject: [PATCH] [Backport]ssl sigalg extension: fix NULL pointer dereference
CVE: CVE-2021-3449
Reference: https://github.com/openssl/openssl/commit/fb9fa6b51defd48157eeb207f52181f735d96148
---
 ssl/statem/extensions.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/ssl/statem/extensions.c b/ssl/statem/extensions.c
index 4ef8b41..4c6e8d7 100644
--- a/ssl/statem/extensions.c
+++ b/ssl/statem/extensions.c
@@ -1136,6 +1136,7 @@ static int init_sig_algs(SSL *s, unsigned int context)
     /* Clear any signature algorithms extension received */
     OPENSSL_free(s->s3->tmp.peer_sigalgs);
     s->s3->tmp.peer_sigalgs = NULL;
+    s->s3->tmp.peer_sigalgslen = 0;
 
     return 1;
 }
-- 
2.1.4

